# مستندات ثبت نام و ورود (Login / Signup)

**نویسنده:** Mahsa Dinani
**تاریخ:** 2025-12-06
**پروژه:** TaskQuest

---

## مقدمه
این سند توضیح می‌دهد که چگونه بخش‌های ثبت‌نام و ورود کاربران در پروژه پیاده‌سازی شده‌اند. هدف اصلی، ایجاد یک سیستم ساده و امن برای مدیریت کاربران با استفاده از دیتابیس SQL Server موجود است.

## تغییرات و پیاده‌سازی‌ها

### 1. اتصال به دیتابیس (Connection String)
برای اتصال به دیتابیس `ToDo.mdf` که در مسیر `P:\Dbs` قرار دارد، تغییر زیر در فایل `Web.config` اعمال شد:

```xml
<connectionStrings>
    <add name="TodoAppDB" 
         connectionString="Data Source=(LocalDB)\MSSQLLocalDB;AttachDbFilename=P:\Dbs\ToDo.mdf;Integrated Security=True;Connect Timeout=30" 
         providerName="System.Data.SqlClient" />
</connectionStrings>
```
این تنظیم به برنامه اجازه می‌دهد تا با استفاده از LocalDB به فایل دیتابیس متصل شود.

### 2. صفحه ثبت‌نام (Sign Up)

#### تغییرات ظاهری (Frontend)
در فایل `SignUp.aspx`، دو فیلد جدید اضافه شد تا اطلاعات کامل‌تری از کاربر دریافت شود:
- **نام کاربری (Username):** برای شناسایی کاربر در سیستم.
- **تکرار رمز عبور (Confirm Password):** برای اطمینان از صحت رمز عبور وارد شده.

#### منطق کد (Backend)
در فایل `SignUp.aspx.cs`، متد `RegisterUser` وظایف زیر را انجام می‌دهد:
1. **دریافت اطلاعات:** مقادیر نام کاربری، ایمیل و رمز عبور از فرم دریافت می‌شوند.
2. **اعتبارسنجی اولیه:** بررسی می‌شود که رمز عبور و تکرار آن یکسان باشند.
3. **بررسی تکراری بودن:** قبل از ثبت، چک می‌شود که آیا کاربری با همین ایمیل یا نام کاربری وجود دارد یا خیر.
4. **هش کردن رمز عبور:** برای امنیت، رمز عبور به صورت متن ساده ذخیره نمی‌شود. از الگوریتم `SHA256` برای تبدیل رمز عبور به یک رشته هش شده استفاده می‌شود.
5. **ذخیره در دیتابیس:** اطلاعات کاربر (نام کاربری، ایمیل، رمز هش شده، تاریخ ثبت نام) در جدول `Users` ذخیره می‌شود.

### 3. صفحه ورود (Login)

#### منطق کد (Backend)
در فایل `Login.aspx.cs`، متد `LoginUser` وظایف زیر را انجام می‌دهد:
1. **جستجوی کاربر:** بر اساس ایمیل وارد شده، نام کاربری و رمز عبور هش شده از دیتابیس بازیابی می‌شود.
2. **بررسی رمز عبور:** رمز عبور وارد شده توسط کاربر هش می‌شود و با هش ذخیره شده در دیتابیس مقایسه می‌گردد.
3. **ورود موفق:** اگر رمزها مطابقت داشته باشند، با استفاده از `FormsAuthentication` کاربر لاگین می‌شود و به صفحه اصلی (`Default.aspx`) هدایت می‌شود.

## ساختار فرضی دیتابیس
کدها بر اساس این فرض نوشته شده‌اند که جدول `Users` در دیتابیس دارای ستون‌های زیر است:
- `Username` (از نوع متنی)
- `Email` (از نوع متنی)
- `PasswordHash` (از نوع متنی - برای ذخیره رمز عبور)
- `CreatedAt` (از نوع تاریخ)

## نحوه استفاده
برای اجرای پروژه، کافی است برنامه را اجرا کرده و وارد صفحه `SignUp.aspx` شوید. پس از ساخت حساب کاربری، به صفحه `Login.aspx` هدایت می‌شوید تا با اطلاعات خود وارد سیستم شوید.
